
// Auto Generated by Tool Version # (1.3.0.3)
// Macrosoft Inc on: 10/6/2018 12:17:32 AM
// Last Updated on: 

using System;
using System.Collections.Generic;
using System.Text;
using System.Data;
using Microsoft.Practices.EnterpriseLibrary.Data;
using EPay.DataClasses;
namespace EPay.DataAccess
{		
	public class RoleDA
	{
		public bool IsDirty {get; set;}
		
		//=================================================================
		//  	public Function LoadAll() As Boolean
		//=================================================================
		//  Loads all of the records in the database, and sets the currentRow to the first row
		//=================================================================
		public List<RoleDC> LoadAll(DBConnection Connection)
		{
			List<RoleDC> objRole = new List<RoleDC>();
			StringBuilder sql = new StringBuilder();
			sql.Append("proc_RolesLoadAll");

			DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);
 
 
            DataSet ds = new DataSet();
			
			if (Connection.Transaction != null)
				ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand, Connection.Transaction);
			else
				ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand);
			
			  foreach (DataRow drRow in ds.Tables[0].Rows)
                {
				objRole.Add(FillObject(drRow));
				}
				
            return objRole;
		}
		
		public RoleDC LoadByPrimaryKey(DBConnection Connection, string RoleID)
		{
			RoleDC objRole = new RoleDC();
			StringBuilder sql = new StringBuilder();
			sql.Append("proc_RolesLoadByPrimaryKey");

			DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);
						dbCommandWrapper.AddInParameter("p_RoleID", DbType.String, RoleID);
 				

			IDataReader reader = null;

			if (Connection.Transaction != null)
				reader = Connection.dataBase.ExecuteReader(dbCommandWrapper.DBCommand, Connection.Transaction);
			else
				reader = Connection.dataBase.ExecuteReader(dbCommandWrapper.DBCommand);

			objRole = FillObject(reader);
            return objRole;
		}
		public int Update(DBConnection Connection, List<RoleDC> objRoles)        
        {
            int updatedCount = 0;
            foreach (RoleDC objRole in objRoles)
            {
                updatedCount = Update(Connection, objRole);
            }
            return updatedCount;
        }
		private int Update(DBConnection Connection, RoleDC objRole)
        {
            int updateCount = 0;

            StringBuilder sql = new StringBuilder();
            sql.Append("proc_RolesUpdate");

            DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);
			
            
			dbCommandWrapper.AddInParameter("p_RoleID", DbType.String, objRole.RoleID);
			dbCommandWrapper.AddInParameter("p_RoleDescription", DbType.String, objRole.RoleDescription);
			dbCommandWrapper.AddInParameter("p_SerialNo", DbType.Int32, objRole.SerialNo);
			dbCommandWrapper.AddInParameter("p_CanView", DbType.Boolean, objRole.CanView);
			dbCommandWrapper.AddInParameter("p_CanAdd", DbType.Boolean, objRole.CanAdd);
			dbCommandWrapper.AddInParameter("p_CanEdit", DbType.Boolean, objRole.CanEdit);
			dbCommandWrapper.AddInParameter("p_CanDelete", DbType.Boolean, objRole.CanDelete);
			dbCommandWrapper.AddInParameter("p_CanPrint", DbType.Boolean, objRole.CanPrint);
			dbCommandWrapper.AddInParameter("p_AddBy", DbType.AnsiStringFixedLength, objRole.AddBy);
			dbCommandWrapper.AddInParameter("p_AddOn", DbType.DateTime, objRole.AddOn);
			dbCommandWrapper.AddInParameter("p_EditBy", DbType.String, objRole.EditBy);
			dbCommandWrapper.AddInParameter("p_EditOn", DbType.DateTime, objRole.EditOn);
			dbCommandWrapper.AddInParameter("p_IsSyncReq", DbType.Boolean, objRole.IsSyncReq);
			dbCommandWrapper.AddInParameter("p_IsSync", DbType.Boolean, objRole.IsSync);
			dbCommandWrapper.AddInParameter("p_RowState", DbType.AnsiStringFixedLength, objRole.RowState);
			dbCommandWrapper.AddInParameter("p_SyncDate", DbType.DateTime, objRole.SyncDate);
			dbCommandWrapper.AddInParameter("p_CompanyID", DbType.Int32, objRole.CompanyID);


            if (Connection.Transaction != null)
                updateCount = Connection.dataBase.ExecuteNonQuery(dbCommandWrapper.DBCommand, Connection.Transaction);
            else
                updateCount = Connection.dataBase.ExecuteNonQuery(dbCommandWrapper.DBCommand);
			
			if (updateCount == 0)
                objRole.IsDirty = IsDirty = true;
            
			return updateCount;
        }
		public int Insert(DBConnection Connection, List<RoleDC> objRoles)        
        {
            int insertCount = 0;
            foreach (RoleDC objRole in objRoles)
            {
                 insertCount = Insert(Connection, objRole);
            }
            return  insertCount;
        }
		private int Insert(DBConnection Connection, RoleDC objRole)
        {
            int insertCount = 0;

            StringBuilder sql = new StringBuilder();
            sql.Append("proc_RolesInsert");

            DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);
			
            
			dbCommandWrapper.AddInParameter("p_RoleID", DbType.String, objRole.RoleID);
			dbCommandWrapper.AddInParameter("p_RoleDescription", DbType.String, objRole.RoleDescription);
			dbCommandWrapper.AddInParameter("p_SerialNo", DbType.Int32, objRole.SerialNo);
			dbCommandWrapper.AddInParameter("p_CanView", DbType.Boolean, objRole.CanView);
			dbCommandWrapper.AddInParameter("p_CanAdd", DbType.Boolean, objRole.CanAdd);
			dbCommandWrapper.AddInParameter("p_CanEdit", DbType.Boolean, objRole.CanEdit);
			dbCommandWrapper.AddInParameter("p_CanDelete", DbType.Boolean, objRole.CanDelete);
			dbCommandWrapper.AddInParameter("p_CanPrint", DbType.Boolean, objRole.CanPrint);
			dbCommandWrapper.AddInParameter("p_AddBy", DbType.String, objRole.AddBy);
			dbCommandWrapper.AddInParameter("p_AddOn", DbType.DateTime, objRole.AddOn);
			dbCommandWrapper.AddInParameter("p_EditBy", DbType.String, objRole.EditBy);
			dbCommandWrapper.AddInParameter("p_EditOn", DbType.DateTime, objRole.EditOn);
			dbCommandWrapper.AddInParameter("p_IsSyncReq", DbType.Boolean, objRole.IsSyncReq);
			dbCommandWrapper.AddInParameter("p_IsSync", DbType.Boolean, objRole.IsSync);
			dbCommandWrapper.AddInParameter("p_RowState", DbType.String, objRole.RowState);
			dbCommandWrapper.AddInParameter("p_SyncDate", DbType.DateTime, objRole.SyncDate);
			dbCommandWrapper.AddInParameter("p_CompanyID", DbType.Int32, objRole.CompanyID);


            if (Connection.Transaction != null)
                insertCount = Connection.dataBase.ExecuteNonQuery(dbCommandWrapper.DBCommand, Connection.Transaction);
            else
                insertCount = Connection.dataBase.ExecuteNonQuery(dbCommandWrapper.DBCommand);

            return insertCount;
        }
		public int Delete(DBConnection Connection, List<RoleDC> objRoles)        
        {
            int deleteCount = 0;
            foreach (RoleDC objRole in objRoles)
            {
                 deleteCount = Delete(Connection, objRole);
            }
            return  deleteCount;
        }
		private int Delete(DBConnection Connection, RoleDC objRole)
        {
            int deleteCount = 0;

            StringBuilder sql = new StringBuilder();
            sql.Append("proc_RolesDelete");

            DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);
            
			dbCommandWrapper.AddInParameter("p_RoleID", DbType.String, objRole.RoleID);

            if (Connection.Transaction != null)
                deleteCount = Connection.dataBase.ExecuteNonQuery(dbCommandWrapper.DBCommand, Connection.Transaction);
            else
                deleteCount = Connection.dataBase.ExecuteNonQuery(dbCommandWrapper.DBCommand);

            return deleteCount;
        }
		private RoleDC FillObject(IDataReader reader)
        {
			RoleDC objRole = null;
            if (reader != null && reader.Read())
            {	
				objRole = new RoleDC();
				objRole.RoleID = (String)reader["RoleID"];
				objRole.RoleDescription = (String)reader["RoleDescription"];
				objRole.SerialNo = (int)reader["SerialNo"];
				objRole.CanView = (Boolean)reader["CanView"];
				objRole.CanAdd = (Boolean)reader["CanAdd"];
				objRole.CanEdit = (Boolean)reader["CanEdit"];
				objRole.CanDelete = (Boolean)reader["CanDelete"];
				objRole.CanPrint = (Boolean)reader["CanPrint"];
				objRole.AddBy = (string)reader["AddBy"];
				objRole.AddOn = (DateTime)reader["AddOn"] ;
				objRole.EditBy = (string)reader["EditBy"];
				objRole.EditOn = (DateTime)reader["EditOn"] ;
				objRole.IsSyncReq = (Boolean)reader["IsSyncReq"];
				objRole.IsSync = (Boolean)reader["IsSync"];
				objRole.RowState = (string)reader["RowState"];
				objRole.SyncDate = reader["SyncDate"] == DBNull.Value ? null : (DateTime?)reader["SyncDate"];
				objRole.CompanyID = reader["CompanyID"] == DBNull.Value ? null : (int?)reader["CompanyID"];

                reader.Close();
                reader.Dispose();
            }
            return objRole;
        }
		private RoleDC FillObject(DataRow row)
        {
			RoleDC objRole = null;
			objRole = new RoleDC();
			objRole.RoleID = (String)row["RoleID"];
			objRole.RoleDescription = (String)row["RoleDescription"];
			objRole.SerialNo = (int)row["SerialNo"];
			objRole.CanView = (Boolean)row["CanView"];
			objRole.CanAdd = (Boolean)row["CanAdd"];
			objRole.CanEdit = (Boolean)row["CanEdit"];
			objRole.CanDelete = (Boolean)row["CanDelete"];
			objRole.CanPrint = (Boolean)row["CanPrint"];
			objRole.AddBy = (string)row["AddBy"];
			objRole.AddOn = row["AddOn"] == DBNull.Value ? null : (DateTime?)row["AddOn"];
			objRole.EditBy = (string)row["EditBy"];
			objRole.EditOn = (DateTime)row["EditOn"] ;
			objRole.IsSyncReq = (Boolean)row["IsSyncReq"];
			objRole.IsSync = (Boolean)row["IsSync"];
			objRole.RowState =(string) row["RowState"];
			objRole.SyncDate = row["SyncDate"] == DBNull.Value ? null : (DateTime?)row["SyncDate"];
			objRole.CompanyID = row["CompanyID"] == DBNull.Value ? null : (int?)row["CompanyID"];

            return objRole;
        }
	}
}

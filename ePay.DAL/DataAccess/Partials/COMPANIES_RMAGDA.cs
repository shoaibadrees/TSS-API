
// Auto Generated by Tool Version # (1.3.0.3)
// Macrosoft Inc on: 4/7/2015 6:50:35 PM
// Last Updated on: 

using System;
using System.Collections.Generic;
using System.Text;
using System.Data;
using Microsoft.Practices.EnterpriseLibrary.Data;
using NMART.DataClasses;
namespace NMART.DataAccess
{
    
    public partial class COMPANIES_RMAGDA
    {

       

        public List<COMPANIES_RMAGDC> GetRmagsByCompanyId(DBConnection Connection, int CompanyId)
        {
            List<COMPANIES_RMAGDC> objCOMPANIES_RMAG = new List<COMPANIES_RMAGDC>();
            StringBuilder sql = new StringBuilder();
            sql.Append("proc_COMPANIES_GetRmagsByCompanyId");

            DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);
            dbCommandWrapper.AddInParameter("p_COMPANY_ID", DbType.Int32, CompanyId);

            DataSet ds = new DataSet();

            if (Connection.Transaction != null)
                ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand, Connection.Transaction);
            else
                ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand);

            foreach (DataRow drRow in ds.Tables[0].Rows)
            {
                objCOMPANIES_RMAG.Add(FillObject(drRow));
            }

            return objCOMPANIES_RMAG;
        }

        public List<COMPANIES_RMAGDC> GetRmagsByCompanyIds(DBConnection objConnection, int CompanyId)
        {

            COMPANIES_RMAGDA objCOMPANIES_RMAGDA = new COMPANIES_RMAGDA();
            List<COMPANIES_RMAGDC> objCOMPANIES_RMAGDC = new List<COMPANIES_RMAGDC>();
            try
            {

                objCOMPANIES_RMAGDC = GetRmagsByCompanyId(objConnection, CompanyId);
            }
            catch (Exception ex)
            {
                throw ex;
            }

            return objCOMPANIES_RMAGDC;
        }
        public List<COMPANIEDC> GetCompaniesByRmags(String Rmags, DBConnection Connection)
        {
            List<COMPANIEDC> objCOMPANIES = new List<COMPANIEDC>();
            StringBuilder sql = new StringBuilder();

            sql.Append("proc_COMPANIES_BY_RMAGS");

            DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);

            dbCommandWrapper.AddInParameter("p_RMAGS", DbType.String, Rmags);
            DataSet ds = new DataSet();

            if (Connection.Transaction != null)
                ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand, Connection.Transaction);
            else
                ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand);

            COMPANIEDC ObjCompany;
            foreach (DataRow drRow in ds.Tables[0].Rows)
            {
                ObjCompany = new COMPANIEDC();
                ObjCompany.COMPANY_ID = (int)drRow["COMPANY_ID"];
                ObjCompany.COMPANY_NAME = (String)drRow["COMPANY_NAME"];
                ObjCompany.RMAG_ID = (int)drRow["RMAG_ID"];
                objCOMPANIES.Add(ObjCompany);
            }

            return objCOMPANIES;
        }

        public List<COMPANIEDC> GetCompaniesByRmagsAndInvitedCompanies(String Rmags,int EventId, DBConnection Connection)
        {
            List<COMPANIEDC> objCOMPANIES = new List<COMPANIEDC>();
            StringBuilder sql = new StringBuilder();

            sql.Append("proc_COMPANIES_BY_RMAGS_AND_INVITED_COMPANIES");

            DBCommandWarpper dbCommandWrapper = new DBCommandWarpper(Connection.dataBase.GetStoredProcCommand(sql.ToString()), Connection);

            dbCommandWrapper.AddInParameter("p_RMAGS", DbType.String, Rmags);
            dbCommandWrapper.AddInParameter("p_Event_Id", DbType.Int16, EventId);

            DataSet ds = new DataSet();

            if (Connection.Transaction != null)
                ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand, Connection.Transaction);
            else
                ds = Connection.dataBase.ExecuteDataSet(dbCommandWrapper.DBCommand);

            COMPANIEDC ObjCompany;
            foreach (DataRow drRow in ds.Tables[0].Rows)
            {
                ObjCompany = new COMPANIEDC();
                ObjCompany.COMPANY_ID = (int)drRow["COMPANY_ID"];
                ObjCompany.COMPANY_NAME = (String)drRow["COMPANY_NAME"];
                ObjCompany.RMAG_ID = (int)drRow["RMAG_ID"];
                objCOMPANIES.Add(ObjCompany);
            }

            return objCOMPANIES;
        }
    }
}
